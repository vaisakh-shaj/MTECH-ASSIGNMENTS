clear;
a{1}=[-1 -1 -1 -1 -1 1 1 -1 -1 -1 -1 -1;
        -1 -1 -1 -1 -1 1 1 -1 -1 -1 -1 -1;
        -1 -1 -1 -1 -1 1 1 -1 -1 -1 -1 -1;
        -1 -1 -1 -1 1 1 1 1 -1 -1 -1 -1;
        -1 -1 -1 1 1 1 1 1 1 -1 -1 -1;
        -1 -1 1 1 1 1 1 1 1 1 -1 -1;
        -1 1 1 1 -1 1 1 -1 1 1 1 -1;
        1 1 1 -1 -1 1 1 -1 -1 1 1 1;
        1 1 -1 -1 -1 1 1 -1 -1 -1 1 1;
        1 -1 -1 -1 -1 1 1 -1 -1 -1 -1 1; 
        -1 -1 -1 -1 1 1 1 1 -1 -1 -1 -1;
        -1 -1 -1 -1 1 -1 -1 1 -1 -1 -1 -1]
a{2}=[-1 -1 -1 -1 -1 1 1 -1 -1 -1 -1 -1; 
      -1 -1 -1 -1 1 1 1 1 -1 -1 -1 -1;
      -1 -1 -1 -1 -1 1 1 -1 -1 -1 -1 -1;
      -1 -1 -1 -1 -1 1 1 -1 -1 -1 -1 -1;
      -1 -1 -1 -1 -1 1 1 -1 -1 -1 -1 -1;
      -1 1 -1 -1 -1 1 1 -1 -1 -1 1 -1;
      -1 -1 1 -1 -1 1 1 -1 -1 1 -1 -1;
      -1 -1 -1 1 1 1 1 1 1 -1 -1 -1;
      -1 -1 1 1 1 1 1 1 1 1 -1 -1;
      -1 -1 -1 1 1 1 1 1 1 -1 -1 -1; 
      -1 -1 1 -1 -1 1 1 -1 -1 1 -1 -1;
      -1 1 -1 -1 -1 -1 -1 -1 -1 -1 1 -1]
a{3}=[-1 -1 -1 -1 1 1 1 1 -1 -1 -1 -1;
      -1 -1 -1 -1 -1 1 1 -1 -1 -1 -1 -1;
      -1 -1 -1 -1 -1 1 1 -1 -1 -1 -1 -1;
      -1 -1 -1 -1 -1 1 1 -1 -1 -1 -1 -1;
      -1 -1 -1 -1 -1 1 1 -1 -1 -1 -1 -1; 
      -1 1 1 -1 -1 1 1 -1 -1 1 1 -1;
      -1 1 1 -1 1 1 1 1 -1 1 1 -1;
      -1 1 1 1 1 1 1 1 1 1 1 -1;
      -1 1 1 1 1 1 1 1 1 1 1 -1;
      -1 1 1 -1 1 1 1 1 -1 1 1 -1;
      -1 1 1 -1 -1 1 1 -1 -1 1 1 -1;
      -1 1 1 -1 -1 -1 -1 -1 -1 1 1 -1]
  b{1}=[-1 -1 -1 1 1 1 1 -1 -1 -1;
       -1 -1 -1 1 1 1 1 -1 -1 -1;
       -1 -1 -1 1 1 1 1 -1 -1 -1;
       -1 -1 -1 1 1 1 1 -1 -1 -1; 
       -1 -1 -1 1 1 1 1 -1 -1 -1; 
       -1 -1 -1 1 1 1 1 -1 -1 -1;
       -1 -1 -1 1 1 1 1 -1 -1 -1;
       -1 -1 -1 1 1 1 1 -1 -1 -1; 
       -1 -1 -1 1 1 1 1 -1 -1 -1; 
       -1 -1 -1 1 1 1 1 -1 -1 -1;
       -1 -1 -1 1 1 1 1 -1 -1 -1;
       -1 -1 -1 1 1 1 1 -1 -1 -1]
   b{2}=[1 1 1 1 1 1 1 1 -1 -1;
        1 1 1 1 1 1 1 1 -1 -1; 
        -1 -1 -1 -1 -1 -1 1 1 -1 -1;
        -1 -1 -1 -1 -1 -1 1 1 -1 -1;
        -1 -1 -1 -1 -1 -1 1 1 -1 -1;
        1 1 1 1 1 1 1 1 -1 -1;
        1 1 1 1 1 1 1 1 -1 -1;
        1 1 -1 -1 -1 -1 -1 -1 -1 -1;
        1 1 -1 -1 -1 -1 -1 -1 -1 -1;
        1 1 -1 -1 -1 -1 -1 -1 -1 -1;
        1 1 1 1 1 1 1 1 -1 -1;
        1 1 1 1 1 1 1 1 -1 -1]
    b{3}=[-1 -1 1 1 1 1 1 1 -1 -1;
           -1 -1 1 1 1 1 1 1 1 -1;
           -1 -1 -1 -1 -1 -1 -1 1 1 -1;
           -1 -1 -1 -1 -1 -1 -1 1 1 -1;
           -1 -1 -1 -1 -1 -1 -1 1 1 -1;
           -1 -1 -1 -1 1 1 1 1 -1 -1
           -1 -1 -1 -1 1 1 1 1 -1 -1;
           -1 -1 -1 -1 -1 -1 -1 1 1 -1;
           -1 -1 -1 -1 -1 -1 -1 1 1 -1;
           -1 -1 -1 -1 -1 -1 -1 1 1 -1;
           -1 -1 1 1 1 1 1 1 1 -1;
           -1 -1 1 1 1 1 1 1 1 -1]
distort=[1 -1 -1 -1 -1 -1 1 1 -1 -1 -1 -1;
      -1 -1 -1 -1 -1 -1 1 1 -1 -1 -1 1;
      -1 -1 -1 1 1 1 1 -1 -1 -1 1 -1;
      -1 1 -1 -1 1 1 -1 1 1 -1 -1 -1;
      1 1 1 1 1 -1 1 1 1 1 1 -1;
      -1 1 1 1 -1 1 1 1 1 1 1 -1;
      -1 1 1 1 -1 1 1 1 1 1 1 -1;
      1 1 1 1 -1 1 1 -1 1 1 1 -1;
      1 1 1 1 -1 1 1 -1 1 1 1 -1;
      1 -1 -1 -1 -1 -1 1 -1 1 1 -1 1;
      1 -1 1 -1 -1 1 1 -1 1 -1 -1 1;
      -1 1 -1 -1 1 -1 1 1 1 -1 -1 -1] 
  [m,n]=size(a{1});
  M=zeros(144,120);
  for i=1:3
      I1=reshape(a{i},[144,1]);
      I2=reshape(a{i},[120,1]);
      M=M+(I)*(I)';
  end
  input=distort;
  c=reshape(input,[144,1])
  output=M*c;
  for i=1:144
      if(output(i)>0)
              output(i)=1;
          end
          if(output(i)<0)
              output(i)=-1;
          end
          if(output(i)==0)
              output(i)=c(i);
          end
  end
  output=reshape(output,[12,12]);
  figure
  imagesc(output)
  title('OUTPUT');